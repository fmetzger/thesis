%!TEX root = ../../dissertation.tex
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{Mobile Core Network Investigation}
\label{chap:mobilenets}

The rise of reliable video streaming is not happening completely independent. Instead, it is deeply embedded into major shifts in Internet access. With more and more smartphones being used and even dial-up Internet access sometimes being replaced with stationary mobile \gls{3G} and \gls{LTE} modems. All these ``over-the-top'' streaming services are now being used within mobile networks.  

These cellular mobile networks are usually based on \gls{3GPP} specifications which have evolved from the circuit switched \gls{GSM} network into the fully packet switched \gls{LTE} which is still in its unrolling phase. But being packet switched does not mean that it shares a lot of similarity with a typical wireline Internet protocol stack and network access infrastructure, for example a \gls{VDSL} or \gls{DOCSIS} dial-up connected to an \gls{IP} network. 

A \gls{3G} network (a term synonymous for the typical combined \gls{GSM} and \gls{UMTS} cellular network in use today) is very distinct from typical wired networks as it provides, amongst others, mobility and authentication in its lower layers through the core specifications rather than being optional on-top services as is typically the case in the Internet.  Thus, large amounts of state have to be kept at and is explicitly communicated among the network nodes in its \gls{CN}. Also, the lines separating layers and functions are very blurred, making it very hard to grasp parts of the architecture without understanding the whole. Many specialized protocols are involved to communicate intents and states in the network. This causes processing overhead and signaling traffic on the network paths on top of the actually useful user traffic. It is a known fact, that radio spectral resources are a scarce resource that needs to be well managed. But it might not seem immediately obvious to think the same about control plane resources in the infrastructure of a mobile network. Yet, there have been situations where the core network has been flooded with signaling, despite only an negligible amount of actual user traffic being transported. \cite{huawei2011storm} \footnote{``Docomo Counts Cost of Signaling Storm'',\url{http://www.lightreading.com/d/d-id/693779}}\footnote{``Android Signaling Storm Rises in Japan'', \url{http://www.lightreading.com/a/d-id/693138}}\footnote{``Angry Birds + Android + ads = network overload'', \url{http://www.itwire.com/business-it-news/47823}} This resulted in ``signaling storm'' causing an unintentional \gls{DDoS} attack, disrupting user-plane connectivity on its way.


The state of research on the architecture and especially the control plane behavior of \gls{3G} mobile cellular networks is lean in comparison to the huge volume of research conducted other wired Internet structures. Most of the available research focuses on user-oriented metrics such as traffic statistics and mobility patterns, or only investigates properties of the radio interface. Little has been published about activity within the core network, and yet less about core signaling. 

Usually, conducting \gls{IP} traffic research at the network's edge, independent of the access technology, is relatively easy. Writing simple tests and measurement scripts, that record the user's traffic, is all that is needed. But mobile phones do not allow one to peek inside its layer 1 and 2 implementation and interaction, where the control plane resides. Any information on this black box can only be indirectly inferred from layers above --- by forcing behavior known from specification --- or below --- through spectrum analysis using \gls{SDN} approaches. 

However, to directly investigate the core as well as the control plane, some kind of a measurement infrastructure inside the network is needed. With this, researchers can not just look into user traffic flowing through the network but also quite easily into the signaling heavy mobile network control plane. To gain this kind of access to the network requires the cooperation of a mobile network operator to gain access, which they grant very reluctantly due to privacy and competitive concerns.

Another important aspect related to signaling is network dimensioning. Operators mostly dimension their networks in accordance to the expected user traffic. But in such a signaling-dependent architecture this might not be the most fitting approach, as the mentioned signaling storms seem to demonstrate. 

This chapter attempts to remedy parts of the problem. Data from an existing mobile network measurement infrastructure is used to evaluate aspects of the control plane. 
To begin, it is absolutely necessary to get a grasp of the finer details of the mobile network architecture under investigation which are given in Section~\ref{c4:3gpparchitecture} followed by a survey of existing literature in Section~\ref{c4:relwork}. Next, an attempt on defining and inferring control plane load in Section~\ref{c4:loaddefinition} is made. This is used to find interesting targets for the evaluation.
Further methodology is given in Section~\ref{c4:methodology} with the  actual evaluation including a statistical analysis to follow in Section~\ref{c4:evaluations}. The measurement data backs up a number of assumptions on the behavior of different device and operating system types, but also reveals some remarkable differences in signaling characteristics. Afterwards, the evaluation results are used to construct load models for the current \gls{CN} in Section~\ref{c4:modeling}. This is extended with possible modifications to it and a numerical simulation to confirm the model viability.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{architecture.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{relwork.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{loaddef.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{methodology.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{stat.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{evaluations.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{queuing.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{modeling.tex}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Summary}
\label{c4:sec:conclusion}


In this paper, we took a look at the signaling behavior of devices in an operational \gls{3G} mobile network providing Internet access. Our focus does not lie on the wireless or user-oriented parts of the network, but on signaling in the core network. To the best of our knowledge, this paper is the first to offer an in-depth core network perspective on signaling. We give a \gls{GPRS} and \gls{UMTS} network primer, and introduce \gls{gtp} tunnel management, explaining the causes and actions within the network. Our evaluation is based on a week long data set acquired in the core network of an Austrian mobile operator.

% We now go back to the case of Angry Birds which was much quoted for causing excessive radio signaling at one point in time. 


In our observation of core network signaling involving \gls{PDP} Contexts and their management, we looked at the effect of device types and operating systems on the duration of \gls{gtp} tunnels. We can conclude that the distribution of tunnel durations in our evaluated dataset is dominated by smartphones. This is contrary to the conventional idea that a larger volume of user plane traffic also leads to an increase of signaling. In our dataset, this would mean that 3G dongles would cause most signaling, which is definitely not the case. Our paper shows that operators can determine which type of device has the most influence on the current network infrastructure by looking at and comparing tunnel duration distributions.

In this aspect, our findings support the stories of the casual game ``Angry Birds'' causing signaling storms in mobile networks by frequently downloading small ads, each small download resulting in disproportionate amounts of signaling load being generated. We conjecture from our results that measures taken to improve the radio interface control plane such as Fast Dormancy can have the converse effects in the core, as they could increase the tunnel churn.


All in all, our paper shows that operators can determine which type of device has the most influence on the current network infrastructure by looking at and comparing tunnel duration distributions. %Moreover, if a load situation occurs in the core network, the operator can decide which devices are the root cause and take appropriate measures. 
This investigations can also lead to better network planning that is more aware of the control plane by providing the necessary tools to identify probable causes for control plane activity. Lastly, we hope to raises some awareness with programmers about the potential unintended side effects their application traffic patterns can cause.

This paper serves as an introduction to the topic of the 3G core network control plane, and therefore provides only some initial insights into the actual signaling dynamics. Therefore, we would like to expand our evaluations, as there are several  angles not investigated so far that could prove worthwhile.

To get a grasp of the imposed load on the network as well as the involved network nodes, a calculation of the sizes of the tunneling messages was already hinted at. To improve on this naive attempt, actual numbers on the message sizes and involved \glspl{IE} could be recorded in future traces. Having correct signaling traffic volume data still does not reveal the processing load on core network elements. We plan to improve our methodology in this respect by taking at a look at how long it takes for the gateway nodes to process \gls{gtp} messages with respect to the current amount of user traffic and signaling. \gls{gtp} tunnels also cause a certain amount of overhead through additional headers and potential fragmentation of the user traffic, providing another investigation venue for the future (albeit more oriented towards user-plane IP traffic). 

Furthermore, besides the device-based classification, a differentiation based on the user traffic dynamics and correlation to signaling is planned. When looking closer at specific users, the mobility behavior also comes to mind. To investigate this, we intend to take a closer look at the occurring tunnel update messages as evidence, amongst others for mobility.

We also look forward to searching for multiple active tunnels per device. As discussed previously, the \textit{Secondary PDP Context Activation Procedure} enables devices to establish up to ten additional tunnels attributed with a different, higher QoS level, if the network supports this. The additional load of managing and holding multiple tunnels plus the displacement of other, ``lower-quality'' traffic could prove to be an interesting investigation. Initial observations indicate that this feature is rarely used today by very few types of devices, but it will be of increased interest in the face of ongoing LTE/EPS deployments, whose specifications expand upon this secondary tunnel concept.

For additional load investigations we also looked at the inter-arrival and processing time of tunnels and found further evidence of radio and diurnal effects influencing the core network. With this data in mind, an initial $M/M/\infty$ queue was created to model load occurring at the \gls{GGSN} with simple stationary analysis. This also serves a basis for future more detailed models.

We think that this investigation and load modeling can lead to better network planning: Being more aware of the control plane provides the necessary tools to identify probable causes for control plane activity. We would also like to expand our evaluations, as there are several angles not investigated so far that could prove worthwhile. This includes an examination of the exact number and size of signaling messages flowing through the core, a more detailed picture of the processing load these messages induce at the \gls{GGSN}, and an evolved model. Furthermore, a differential analysis of our data compared to a newer dataset (potentially including \gls{LTE} access) could really prove worthwhile.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% MMB2014 Conclusion Starts here
In this paper we investigated trade-offs when virtualizing components of the mobile core network.

To this end, we first discussed a novel approach to mobile core network load modeling based on the control plane load at the \gls{GGSN}. The $M/G/c_c$ loss model is based on the currently implemented state of the network architecture and can serve as a baseline reference to plan and dimension one's own mobile network accordingly, not just based on expected user traffic as traditionally. To improve scaling in the future, we proposed a completely new and virtualizable approach to a \gls{GGSN}'s makeup.

Then, we presented random variables to model load in a \gls{GGSN} based on measurement data from the network of a nation-wide mobile service provider and made them available for reuse by other researchers.

Finally, we evaluate the model using a queing simulation. We have shown, that the system's blocking probability is roughly equal to the single-server model but in addition achieves large efficiency gains, even with very simplistic provisioning conditions and very long boot times. The model also has the ability to very easily scale out one's infrastructure by simply adding more small servers, reducing operational overhead. This might even lead to a new \gls{GGSN}-as-a-Service business models, removing the need to provide and operate large amounts of infrastructure for rare cases of peak load. 
In the future we would like to deepen our modeling efforts to provide more dimensioning options for a core network. Also, we want to further investigate the correlation of user traffic and signaling and take a look at the implications specific traffic types bring for the core network. 